<script setup lang="ts">
import { TkPageCard } from "vitepress-theme-teek";
import { ref, computed } from "vue";

// æ’ä»¶æ•°æ®
const plugins = ref([
  {
    id: 'imoulife',
    title: 'ä¹æ©™/ImouLife',
    icon: 'ğŸ¥',
    price: 'Â¥å®šä»·ä¸­',
    category: 'åè®®æ¥å…¥',
    description: 'å¯¹æ¥ä¹æ©™/ImouLifeå¹³å°ï¼Œæ”¯æŒè®¾å¤‡ç›´æ’­ã€ç‚¹æ’­ã€äº‘å°æ§åˆ¶ä¸å›æ”¾ç­‰å¸¸è§èƒ½åŠ›',
    features: [
      'è®¾å¤‡é¢„è§ˆ',
      'äº‘å°æ§åˆ¶(PTZ)',
      'äº‘å­˜å‚¨å›æ”¾',
      'æ¨æµ/æ‹‰æµURLç”Ÿæˆ',
    ],
    scenarios: ['è§†é¢‘ç›‘æ§çœ‹æ¿', 'è®¾å¤‡è”åŠ¨è§†é¢‘', 'å”®åè¿œç¨‹æŸ¥çœ‹'],
    badge: 'å¢å€¼æœåŠ¡',
    badgeColor: 'warning'
  },
  {
    id: 'ctaiot-access',
    title: 'å¤©ç¿¼ç‰©è”æ¥å…¥',
    icon: 'ğŸ“¡',
    price: 'Â¥å®šä»·ä¸­',
    category: 'åè®®æ¥å…¥',
    description: 'æ”¯æŒæ— ç¼æ¥å…¥å¤©ç¿¼AIOTï¼Œäº§å“ç®¡ç†ã€è®¾å¤‡ç®¡ç†éƒ½ç»Ÿä¸€åœ¨nexiotä¸‹',
    features: [
      'æ— ç¼å¤©ç¿¼AIOTæ¥å…¥',
      'ç»Ÿä¸€äº§å“ç®¡ç†',
      'ç»Ÿä¸€è®¾å¤‡ç®¡ç†',
      'NB-IoTè®¾å¤‡æ”¯æŒ',
      '5Gè®¾å¤‡æ”¯æŒ',
      'ç”µä¿¡è¿è¥å•†APIé›†æˆ'
    ],
    scenarios: ['ç”µä¿¡è¿è¥å•†åˆä½œ', 'NB-IoTé¡¹ç›®', '5Gç‰©è”ç½‘åº”ç”¨'],
    badge: 'ä¼ä¸šå¿…å¤‡',
    badgeColor: 'primary'
  },
  {
    id: 'tcp-direct',
    title: 'TCPç›´è¿æ¥å…¥',
    icon: 'ğŸ”Œ',
    price: 'Â¥å®šä»·ä¸­',
    category: 'åè®®æ¥å…¥',
    description: 'æ”¯æŒè‡ªå®šä¹‰åè®®ã€Modbusç­‰TCPé€šä¿¡æ–¹å¼ï¼Œæ”¯æŒSNI TLSé€šé…ç¬¦åŸŸåæ¥å…¥ã€TCPé›†ç¾¤ã€æ— é™æ‰©å±•èŠ‚ç‚¹',
    features: [
      'è‡ªå®šä¹‰åè®®æ”¯æŒ',
      'Modbus TCPé€šä¿¡',
      'SNI TLSé€šé…ç¬¦åŸŸå',
      'TCPé›†ç¾¤éƒ¨ç½²',
      'æ— é™æ‰©å±•èŠ‚ç‚¹',
      'é«˜æ€§èƒ½å¹¶å‘å¤„ç†',
      'èµ é€å°ç¨‹åºçš„èƒ½åŠ›'
    ],
    scenarios: ['å·¥ä¸šè®¾å¤‡æ¥å…¥', 'ä¼ æ„Ÿå™¨ç½‘ç»œ', 'å¤§è§„æ¨¡TCPè®¾å¤‡ç®¡ç†'],
    badge: 'ä¼ä¸šå¿…å¤‡',
    badgeColor: 'success'
  },
  {
    id: 'custom-protocol',
    title: 'å®šåˆ¶éœ€æ±‚æ¥å…¥',
    icon: 'âš™ï¸',
    price: 'æŒ‰å·¥ä½œé‡è¯„ä¼°',
    category: 'åè®®æ¥å…¥',
    description: 'æ ¹æ®æ‚¨çš„å…·ä½“ä¸šåŠ¡éœ€æ±‚ï¼Œå®šåˆ¶å¼€å‘ä¸“å±åè®®æ¥å…¥æ–¹æ¡ˆï¼Œæ»¡è¶³ç‰¹æ®Šåœºæ™¯çš„è®¾å¤‡è¿æ¥éœ€æ±‚',
    features: [
      'ä¸“å±åè®®å¼€å‘',
      'å®šåˆ¶åŒ–æ•°æ®è§£æ',
      'ç‰¹æ®Šè®¾å¤‡é€‚é…',
      'ä¸ªæ€§åŒ–åŠŸèƒ½å®ç°',
      'ä¸“ä¸šæŠ€æœ¯æ”¯æŒ',
      'æºç äº¤ä»˜'
    ],
    scenarios: ['ç‰¹æ®Šå·¥ä¸šè®¾å¤‡', 'ç§æœ‰åè®®æ¥å…¥', 'å®šåˆ¶åŒ–è§£å†³æ–¹æ¡ˆ', 'ä¼ä¸šä¸“å±éœ€æ±‚'],
    badge: 'å®šåˆ¶',
    badgeColor: 'info'
  }
  
]);

// æŒ‰åˆ†ç±»åˆ†ç»„
const pluginsByCategory = computed(() => {
  const grouped: Record<string, typeof plugins.value> = {};
  plugins.value.forEach(plugin => {
    if (!grouped[plugin.category]) {
      grouped[plugin.category] = [];
    }
    grouped[plugin.category].push(plugin);
  });
  return grouped;
});

// è·å–å¾½ç« æ ·å¼ç±»
const getBadgeClass = (color: string) => {
  const colorMap: Record<string, string> = {
    'success': 'badge-success',
    'primary': 'badge-primary', 
    'warning': 'badge-warning',
    'info': 'badge-info'
  };
  return colorMap[color] || 'badge-default';
};

// äºŒç»´ç å¼¹çª—
const showWx = ref(false);
const openWx = () => (showWx.value = true);
const closeWx = () => (showWx.value = false);

// æˆæƒç‰ˆæœ¬æ•°æ®
const licenses = ref([
  {
    id: 'license-standard',
    title: 'å•†ç”¨æˆæƒ',
    icon: 'ğŸ§¾',
    price: 'Â¥å®šä»·ä¸­',
    description: 'æ°¸ä¹…å•†ç”¨æˆæƒï¼Œæ‹¥æœ‰å¼€æºç‰ˆæœ¬çš„å…¨éƒ¨åŠŸèƒ½ï¼Œä¸é™å›¢é˜Ÿæˆå‘˜æ•°é‡ä¸éƒ¨ç½²èŠ‚ç‚¹ã€‚',
    features: [
      'æ°¸ä¹…æˆæƒï¼Œä¸é™èŠ‚ç‚¹',
      'åŒ…å«å¼€æºç‰ˆå…¨éƒ¨åŠŸèƒ½',
      'å…è®¸å•†ä¸šä½¿ç”¨ä¸äºŒæ¬¡å¼€å‘'
    ],
    badge: 'æ¨è',
    badgeColor: 'success'
  },
  {
    id: 'license-out-of-box',
    title: 'å¼€ç®±ç‰ˆ',
    icon: 'ğŸ“¦',
    price: 'Â¥å®šä»·ä¸­',
    description: 'é™æ—¶ç‰¹ä»·ï¼Œä¸ç”¨æŠ˜è…¾ï¼Œç›´æ¥å¯ç”¨ã€‚ä½ æä¾›æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¸®å¿™éƒ¨ç½²å’Œç»´æŠ¤ï¼Œå¼€ç®±å³ç”¨ã€‚',
    features: [
      'æ•°æ®åœ¨è‡ªå·±æ‰‹ä¸Š',
      'ä¸“ä¸šéƒ¨ç½²ä¸ç»´æŠ¤',
      'å¼€ç®±å³ç”¨ï¼Œé›¶é…ç½®',
      'å¦‚éœ€æºç ç®¡ç†å¯å‡çº§ä¼ä¸šç‰ˆ'
    ],
    badge: 'çœå¿ƒ',
    badgeColor: 'info'
  },
  {
    id: 'license-enterprise',
    title: 'ä¼ä¸šç‰ˆ',
    icon: 'ğŸ¢',
    price: 'Â¥å®šä»·ä¸­',
    description: '1å¹´å•†ä¸šä»£ç ä»“åº“æ›´æ–°ï¼ŒåŒ…å«å¹³å°æ‰€æœ‰åŠŸèƒ½å’Œä¸‹æ–¹æ¥å…¥æ¨¡å—ï¼Œé€‚åˆä¸­å°å›¢é˜Ÿä¸ä¼ä¸šé¡¹ç›®äº¤ä»˜ã€‚',
    features: [
      '1å¹´å•†ä¸šä»“åº“æ›´æ–°ï¼ˆå«ä¼˜åŒ– & Bug ä¿®å¤ï¼‰',
      'åŒ…å«å¹³å°æ‰€æœ‰åŠŸèƒ½',
      'å•†ä¸šé¡¹ç›®ä¼˜å…ˆæ”¯æŒ',
      'åŒ…å«æ‰€æœ‰åè®®æ¥å…¥æ¨¡å—'
    ],
    badge: 'ä¼ä¸š',
    badgeColor: 'primary'
  },
  {
    id: 'license-flagship',
    title: 'æ——èˆ°ç‰ˆ',
    icon: 'ğŸš€',
    price: 'Â¥å®šä»·ä¸­',
    description: 'åŒ…å«ä¼ä¸šæˆæƒå…¨éƒ¨æƒé™ï¼Œé…ç½®ç‹¬ç«‹ä¸“äººç»´æŠ¤ä¸é—®é¢˜ä¿®å¤ï¼Œé€‚åˆå¤§å‹ä¼ä¸šä¸é•¿æœŸè¿ç»´ã€‚',
    features: [
      'ä¸“å±æŠ€æœ¯æ”¯æŒä¸é—®é¢˜ä¿®å¤',
      'é¡¹ç›®å®æ–½ä¸æ€§èƒ½ä¼˜åŒ–å»ºè®®',
      'å¯å®šåˆ¶äº¤ä»˜æ–¹æ¡ˆ',
      "å¯ååŠ©ç§æœ‰åŒ–éƒ¨ç½²"
    ],
    badge: 'å®šåˆ¶',
    badgeColor: 'warning'
  }
]);
</script>

<template>
  <div class="commercial-plugins">
  <!-- æˆæƒç‰ˆæœ¬æ¨¡å—ï¼ˆæ”¾åˆ°æœ€å‰é¢ï¼‰ -->
  <div class="plugin-category">
      <h2>ğŸ“¦ æˆæƒç‰ˆæœ¬</h2>
      <div class="plugin-grid">
        <TkPageCard
          v-for="item in licenses"
          :key="item.id"
          :title="item.title"
          class="plugin-card"
        >
          <template #title>
            <div class="plugin-header">
              <span class="plugin-icon">{{ item.icon }}</span>
              <span class="plugin-title">{{ item.title }}</span>
              <span :class="['plugin-badge', getBadgeClass(item.badgeColor)]">{{ item.badge }}</span>
            </div>
          </template>

          <div class="plugin-content">
            <div class="plugin-price">{{ item.price }}</div>
            <p class="plugin-description">{{ item.description }}</p>

            <div class="plugin-features">
              <h4>âœ¨ åŒ…å«å†…å®¹</h4>
              <ul>
                <li v-for="feature in item.features" :key="feature">{{ feature }}</li>
              </ul>
            </div>

            <div class="plugin-actions">
              <button class="btn-primary" @click="openWx">ç‚¹å‡»æ‰«ç </button>
            </div>
          </div>
        </TkPageCard>
      </div>
    </div>
    <!-- åè®®æ¥å…¥æ¨¡å— -->
    <div class="plugin-category">
      <h2>ğŸ”Œ åè®®æ¥å…¥æ¨¡å—</h2>
      <div class="plugin-grid">
        <TkPageCard 
          v-for="plugin in pluginsByCategory['åè®®æ¥å…¥']" 
          :key="plugin.id"
          :title="plugin.title"
          class="plugin-card"
        >
          <template #title>
            <div class="plugin-header">
              <span class="plugin-icon">{{ plugin.icon }}</span>
              <span class="plugin-title">{{ plugin.title }}</span>
              <span :class="['plugin-badge', getBadgeClass(plugin.badgeColor)]">
                {{ plugin.badge }}
              </span>
            </div>
          </template>
          
          <div class="plugin-content">
            <div class="plugin-price">{{ plugin.price }}</div>
            <p class="plugin-description">{{ plugin.description }}</p>
            
            <div class="plugin-features">
              <h4>âœ¨ æ ¸å¿ƒåŠŸèƒ½</h4>
              <ul>
                <li v-for="feature in plugin.features" :key="feature">
                  {{ feature }}
                </li>
              </ul>
            </div>
            
            <div class="plugin-scenarios">
              <h4>ğŸ¯ é€‚ç”¨åœºæ™¯</h4>
              <div class="scenario-tags">
                <span 
                  v-for="scenario in plugin.scenarios" 
                  :key="scenario"
                  class="scenario-tag"
                >
                  {{ scenario }}
                </span>
              </div>
            </div>
            
            <div class="plugin-actions">
              <button class="btn-primary" @click="openWx">ç‚¹å‡»æ‰«ç </button>
              <!-- <button class="btn-secondary">å…è´¹è¯•ç”¨</button> -->
            </div>
          </div>
        </TkPageCard>
      </div>
    </div>

    <!-- äºŒç»´ç å¼¹çª—ï¼ˆä¸å½“å‰é¡µé¢åŒæ ¹ï¼‰ -->
    <div v-if="showWx" class="wx-modal" @click.self="closeWx">
      <div class="wx-modal__content">
        <img src="/wx.png" alt="å¾®ä¿¡äºŒç»´ç " />
        <p>æ‰«ç æ·»åŠ å¾®ä¿¡ï¼Œå¤‡æ³¨ï¼šæˆæƒ/å’¨è¯¢</p>
        <button class="wx-modal__close" @click="closeWx">å…³é—­</button>
      </div>
    </div>

  </div>
</template>

<style scoped>
.commercial-plugins {
  margin: 1.25rem 0;
}

.plugin-category {
  margin-bottom: 2rem;
}

.plugin-category h2 {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
  color: var(--vp-c-text-1);
  border-bottom: 2px solid var(--vp-c-brand);
  padding-bottom: 0.5rem;
}

.plugin-grid {
  display: grid;
  /* æ›´ç´§å‡‘çš„é—´è·ï¼Œè‡ªåŠ¨å¡«æ»¡å±å¹• */
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1rem;
  margin-bottom: 1.25rem;
}

.plugin-card {
  transition: all 0.3s ease;
  border: 1px solid var(--vp-c-border);
  border-radius: 12px;
  overflow: hidden;
}

.plugin-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-color: var(--vp-c-brand);
}

.plugin-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.plugin-icon {
  font-size: 1.5rem;
}

.plugin-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--vp-c-text-1);
  flex: 1;
}

.plugin-badge {
  padding: 0.25rem 0.75rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.badge-success {
  background: linear-gradient(135deg, #10b981, #059669);
  color: white;
}

.badge-primary {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: white;
}

.badge-warning {
  background: linear-gradient(135deg, #f59e0b, #d97706);
  color: white;
}

.badge-info {
  background: linear-gradient(135deg, #06b6d4, #0891b2);
  color: white;
}

.plugin-content {
  padding: 0;
}

.plugin-price {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--vp-c-brand);
  margin-bottom: 1rem;
  text-align: center;
}

.plugin-description {
  color: var(--vp-c-text-2);
  line-height: 1.6;
  margin-bottom: 1.5rem;
  font-size: 0.95rem;
}

.plugin-features h4,
.plugin-scenarios h4 {
  font-size: 1rem;
  font-weight: 600;
  color: var(--vp-c-text-1);
  margin-bottom: 0.75rem;
}

.plugin-features ul {
  list-style: none;
  padding: 0;
  margin-bottom: 1.5rem;
}

.plugin-features li {
  padding: 0.5rem 0;
  color: var(--vp-c-text-2);
  position: relative;
  padding-left: 1.5rem;
}

.plugin-features li::before {
  content: "âœ“";
  position: absolute;
  left: 0;
  color: var(--vp-c-brand);
  font-weight: bold;
}

.scenario-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

.scenario-tag {
  padding: 0.25rem 0.75rem;
  background: var(--vp-c-bg-soft);
  color: var(--vp-c-text-2);
  border-radius: 16px;
  font-size: 0.85rem;
  border: 1px solid var(--vp-c-border);
}

.plugin-actions {
  display: flex;
  gap: 0.75rem;
  margin-top: 1.5rem;
}

.btn-primary,
.btn-secondary {
  flex: 1;
  padding: 0.75rem 1rem;
  border-radius: 8px;
  font-weight: 500;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
}

.btn-primary {
  background: linear-gradient(135deg, var(--vp-c-brand), #2563eb);
  color: white;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.btn-secondary {
  background: transparent;
  color: var(--vp-c-brand);
  border: 1px solid var(--vp-c-brand);
}

.btn-secondary:hover {
  background: var(--vp-c-brand);
  color: white;
  transform: translateY(-2px);
}

/* ç®€æ˜“äºŒç»´ç å¼¹çª— */
.wx-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.wx-modal__content {
  background: var(--vp-c-bg);
  border: 1px solid var(--vp-c-border);
  border-radius: 12px;
  padding: 20px;
  width: min(90vw, 420px);
  text-align: center;
}
.wx-modal__content img {
  width: 100%;
  height: auto;
  border-radius: 8px;
}
.wx-modal__content p {
  margin: 12px 0 8px;
  color: var(--vp-c-text-2);
}
.wx-modal__close {
  margin-top: 6px;
  padding: 6px 12px;
  border: 1px solid var(--vp-c-brand);
  background: transparent;
  color: var(--vp-c-brand);
  border-radius: 8px;
  cursor: pointer;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .plugin-grid {
    grid-template-columns: 1fr;
    gap: 0.75rem;
  }
  
  .plugin-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  
  .plugin-actions {
    flex-direction: column;
  }
}
</style>
