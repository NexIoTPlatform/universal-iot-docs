---
title: 02.创建产品与配置
date: 2025-03-05 21:25:02
permalink: /iot/mqtt/createProduct
categories:
  - 设备接入
tags:
  - 设备接入
---

# MQTT产品创建与配置

## 接入流程概述

::: details 必看步骤 {open}

- 1.创建产品-选择 `MQTT`
- 2.导入物模型
- 3.开始上报数据

:::

## 产品创建

### 创建MQTT产品

MQTT产品创建页面提供完整的产品配置功能，选择MQTT接入方式并配置产品的基本信息。页面支持产品名称、描述、接入方式等基础配置。

![mqttCreate](/02/mqtt/mqttCreate.png "MQTT产品创建页面 - 选择MQTT接入方式并配置基本信息")

### 自动注册配置

为了简化设备接入流程，平台提供自动注册功能。开启自动注册后，新设备连接时会自动创建设备记录，无需手动添加设备。

![autoRe](/02/mqtt/autoRe.png "自动注册配置 - 开启设备自动注册功能")

## 物模型配置

### 物模型导入

物模型导入页面支持通过JSON格式导入预定义的物模型配置。平台提供标准的物模型模板，支持快速配置设备的能力定义。

![importtsl](/02/mqtt/importtsl.png "物模型导入页面 - 支持JSON格式导入预定义配置")

> **物模型模板**：点击下方代码块可直接复制使用

```json
{
  "tags": [],
  "events": [
    { "id": "overload", "name": "过载报警", "valueType": { "type": "int", "unit": "W" } },
    { "id": "online", "name": "上线", "valueType": { "type": "string" } },
    { "id": "offline", "name": "下线", "valueType": { "type": "string" } }
  ],
  "functions": [
    {
      "id": "switch",
      "name": "开关控制",
      "config": false,
      "inputs": [
        {
          "id": "state",
          "valueType": {
            "type": "enum",
            "elements": [
              { "text": "开", "value": "01" },
              { "text": "关", "value": "00" }
            ]
          }
        },
        { "id": "deviceId", "name": "设备编号", "valueType": { "type": "string", "expands": { "maxLength": "50" } } }
      ],
      "output": {}
    }
  ],
  "properties": [
    {
      "id": "powerState",
      "mode": "rw",
      "name": "开关状态",
      "valueType": {
        "type": "enum",
        "elements": [
          { "text": "开", "value": "01" },
          { "text": "关", "value": "00" }
        ]
      }
    },
    { "id": "current", "mode": "r", "name": "电流", "valueType": { "type": "float", "unit": "A" } },
    { "id": "voltage", "mode": "r", "name": "电压", "valueType": { "type": "float", "unit": "V" } },
    { "id": "power", "mode": "r", "name": "功率", "valueType": { "type": "int", "unit": "W" } }
  ]
}
```

## MQTT参数配置

### 产品侧配置

在产品侧，MQTT通常不需要额外的特殊设置，平台会自动处理MQTT连接的建立和维护。

### MQTT认证配置

平台支持多种MQTT认证方式，主要使用MySQL的账号和密码ACL方式，设置账号的主题在一定的规则下面发布和订阅权限。

假设您是某产品`${productKey}`的开发者，平台侧会分配相应的用户和密码规则。

::: tip MQTT权限设置

**物模型主题规范**：

- `$thing/up/event/${productKey}/+` - 事件上报主题
- `$thing/up/property/${productKey}/+` - 属性上报主题
- `$thing/down/${productKey}/+` - 指令下发主题

:::
