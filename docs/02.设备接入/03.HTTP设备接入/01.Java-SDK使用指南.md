---
title: 01.Java SDKä½¿ç”¨æŒ‡å—
date: 2025-03-05 21:25:02
permalink: /iot/http/java-sdk
categories:
  - è®¾å¤‡æ¥å…¥
tags:
  - è®¾å¤‡æ¥å…¥
---

# Java SDKä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç»Universal IoT Platformçš„Java SDKä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬SDKå®‰è£…ã€APIè°ƒç”¨ã€ç¤ºä¾‹ä»£ç ç­‰å†…å®¹ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”§ **è®¾å¤‡ç®¡ç†**: æ”¯æŒè®¾å¤‡çš„æ³¨å†Œã€æŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤
- ğŸ“¡ **è®¾å¤‡é€šä¿¡**: æ”¯æŒè®¾å¤‡ä¸Šçº¿ã€ä¸‹çº¿çŠ¶æ€ç®¡ç†
- ğŸ“Š **æ•°æ®ä¸ŠæŠ¥**: æ”¯æŒå±æ€§ä¸ŠæŠ¥å’Œäº‹ä»¶ä¸ŠæŠ¥
- ğŸ” **å®‰å…¨è®¤è¯**: æ”¯æŒOAuth2å®¢æˆ·ç«¯è®¤è¯å’Œå¯†ç è®¤è¯
- ğŸ› ï¸ **æ˜“äºé›†æˆ**: æä¾›ç®€æ´çš„APIæ¥å£ï¼Œæ˜“äºé›†æˆåˆ°ç°æœ‰ç³»ç»Ÿ

## ç¯å¢ƒè¦æ±‚

- Java 8 æˆ–æ›´é«˜ç‰ˆæœ¬
- Maven 3.6+ æˆ– Gradle 6.0+
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äºè®¿é—®IoTå¹³å°APIï¼‰

## å¿«é€Ÿå¼€å§‹

### 1. æ·»åŠ ä¾èµ–

#### Maven

```xml
<dependency>
    <groupId>cc.teambee</groupId>
    <artifactId>universal-iot-openapi-sdk</artifactId>
    <version>1.0.0</version>
</dependency>
```


### 2. é…ç½®è®¤è¯ä¿¡æ¯

åœ¨ `src/main/resources/config/` ç›®å½•ä¸‹åˆ›å»º `uiot.properties` æ–‡ä»¶ï¼š

```properties
# æœåŠ¡åœ°å€
universal.iot.host=host:port

# å®¢æˆ·ç«¯è®¤è¯å‚æ•°
universal.iot.clientId=your-client-id
universal.iot.clientSecret=your-client-secret

# å¯†ç è®¤è¯å‚æ•°ï¼ˆå¯é€‰ï¼‰
universal.iot.username=your-username
universal.iot.password=your-password

# è®¤è¯ç±»å‹ï¼špassword æˆ– client_credentials
universal.iot.grantType=client_credentials
```

### 3. åˆ›å»ºIoTå®¢æˆ·ç«¯

```java
import cc.teambee.iot.http.IoTClient;
import cc.teambee.iot.http.IoTClientImpl;
import cc.teambee.iot.common.exception.ClientException;

public class IoTExample {
    public static void main(String[] args) {
        try {
            // åˆ›å»ºIoTå®¢æˆ·ç«¯
            IoTClient iotClient = new IoTClientImpl();

            // ä½¿ç”¨å®¢æˆ·ç«¯è¿›è¡Œæ“ä½œ...

        } catch (ClientException e) {
            e.printStackTrace();
        }
    }
}
```

## API ä½¿ç”¨æŒ‡å—

### è®¾å¤‡æ³¨å†Œ(æ·»åŠ )

è®¾å¤‡æ³¨å†Œæ˜¯ä½¿ç”¨SDKçš„ç¬¬ä¸€æ­¥ï¼Œéœ€è¦æä¾›è®¾å¤‡çš„åŸºæœ¬ä¿¡æ¯ã€‚

```java
import cc.teambee.iot.entity.v2025.CreateDeviceRequest;

// åˆ›å»ºè®¾å¤‡æ³¨å†Œè¯·æ±‚
String productKey = "your-product-key";
CreateDeviceRequest request = new CreateDeviceRequest(productKey);

// è®¾ç½®è®¾å¤‡åŸºæœ¬ä¿¡æ¯
request.setDeviceId("device-001");
request.setDeviceName("æ™ºèƒ½ä¼ æ„Ÿå™¨");
request.setLatitude("31.207561");
request.setLongitude("120.23475");

// å¯é€‰ï¼šæ·»åŠ è‡ªå®šä¹‰æ•°æ®
request.addData("entity", "123456");

// æ‰§è¡Œæ³¨å†Œ
String result = iotClient.register(request);
System.out.println("è®¾å¤‡æ³¨å†Œç»“æœ: " + result);
```

**å¿…å¡«å‚æ•°**:

- `deviceId`: è®¾å¤‡å”¯ä¸€æ ‡è¯†ç¬¦
- `deviceName`: è®¾å¤‡åç§°
- `latitude`: è®¾å¤‡çº¬åº¦
- `longitude`: è®¾å¤‡ç»åº¦

**å¯é€‰å‚æ•°**:

- `ignoreRepeat`: æ˜¯å¦å¿½ç•¥é‡å¤æ³¨å†Œ
- `detail`: è®¾å¤‡å¤‡æ³¨ä¿¡æ¯
- `code`: æ‘„åƒå¤´ç±»è®¾å¤‡éªŒè¯ç 
- `deviceKey`: è®¾å¤‡å¯†é’¥

### è®¾å¤‡ä¸Šçº¿

è®¾å¤‡ä¸Šçº¿è¡¨ç¤ºè®¾å¤‡å·²è¿æ¥åˆ°IoTå¹³å°ï¼Œå¯ä»¥å¼€å§‹æ¥æ”¶å’Œå‘é€æ•°æ®ã€‚

```java
import cc.teambee.iot.entity.GeneralResponse;

// è®¾å¤‡ä¸Šçº¿
GeneralResponse response = iotClient.online(productKey, deviceId);

if (response.getCode() == 0) {
    System.out.println("è®¾å¤‡ä¸Šçº¿æˆåŠŸ");
} else {
    System.out.println("è®¾å¤‡ä¸Šçº¿å¤±è´¥: " + response.getMessage());
}
```

### å±æ€§ä¸ŠæŠ¥

å±æ€§ä¸ŠæŠ¥ç”¨äºå‘å¹³å°æŠ¥å‘Šè®¾å¤‡çš„å½“å‰çŠ¶æ€å’Œå±æ€§å€¼ã€‚

```java
import java.util.HashMap;
import java.util.Map;

// æ„å»ºå±æ€§æ•°æ®
Map<String, Object> properties = new HashMap<>();
properties.put("temperature", 25.5);
properties.put("humidity", 60.0);
properties.put("switchStatus", 1);

// ä¸ŠæŠ¥å±æ€§
GeneralResponse response = iotClient.reportProperties(productKey, deviceId, properties);

if (response.getCode() == 0) {
    System.out.println("å±æ€§ä¸ŠæŠ¥æˆåŠŸ");
} else {
    System.out.println("å±æ€§ä¸ŠæŠ¥å¤±è´¥: " + response.getMessage());
}
```

### äº‹ä»¶ä¸ŠæŠ¥

äº‹ä»¶ä¸ŠæŠ¥ç”¨äºå‘å¹³å°æŠ¥å‘Šè®¾å¤‡å‘ç”Ÿçš„ç‰¹å®šäº‹ä»¶ã€‚

```java
// æ„å»ºäº‹ä»¶æ•°æ®
Map<String, Object> eventData = new HashMap<>();
eventData.put("alarmLevel", "high");
eventData.put("alarmMessage", "æ¸©åº¦è¿‡é«˜");

// ä¸ŠæŠ¥äº‹ä»¶
GeneralResponse response = iotClient.reportEvent(
    productKey,
    deviceId,
    "temperatureAlarm",
    eventData
);

if (response.getCode() == 0) {
    System.out.println("äº‹ä»¶ä¸ŠæŠ¥æˆåŠŸ");
} else {
    System.out.println("äº‹ä»¶ä¸ŠæŠ¥å¤±è´¥: " + response.getMessage());
}
```

### è®¾å¤‡æŸ¥è¯¢

æŸ¥è¯¢è®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯ã€‚

```java
// æŸ¥è¯¢è®¾å¤‡ä¿¡æ¯
GeneralResponse response = iotClient.query(productKey, deviceId);

if (response.getCode() == 0) {
    System.out.println("è®¾å¤‡ä¿¡æ¯: " + response.getResult());
} else {
    System.out.println("æŸ¥è¯¢å¤±è´¥: " + response.getMessage());
}
```

### è®¾å¤‡æ›´æ–°

æ›´æ–°è®¾å¤‡çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚åç§°ã€ä½ç½®ã€å¤‡æ³¨ç­‰ã€‚

```java
import cc.teambee.iot.entity.v2025.UpdateDeviceRequest;

// åˆ›å»ºæ›´æ–°è¯·æ±‚
UpdateDeviceRequest updateRequest = new UpdateDeviceRequest(productKey, deviceId);

// è®¾ç½®æ›´æ–°ä¿¡æ¯
updateRequest.setDeviceName("æ›´æ–°åçš„è®¾å¤‡åç§°");
updateRequest.setLatitude("31.207562");
updateRequest.setLongitude("120.23476");
updateRequest.setDetail("è®¾å¤‡å¤‡æ³¨ä¿¡æ¯");

// æ‰§è¡Œæ›´æ–°
GeneralResponse response = iotClient.update(updateRequest);

if (response.getCode() == 0) {
    System.out.println("è®¾å¤‡æ›´æ–°æˆåŠŸ");
} else {
    System.out.println("è®¾å¤‡æ›´æ–°å¤±è´¥: " + response.getMessage());
}
```

### è®¾å¤‡åˆ é™¤

ä»IoTå¹³å°åˆ é™¤è®¾å¤‡ã€‚

```java
// åˆ é™¤è®¾å¤‡
GeneralResponse response = iotClient.delete(productKey, deviceId);

if (response.getCode() == 0) {
    System.out.println("è®¾å¤‡åˆ é™¤æˆåŠŸ");
} else {
    System.out.println("è®¾å¤‡åˆ é™¤å¤±è´¥: " + response.getMessage());
}
```

## å®Œæ•´ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„è®¾å¤‡ç”Ÿå‘½å‘¨æœŸç®¡ç†ç¤ºä¾‹ï¼š

```java
import cc.teambee.iot.http.IoTClient;
import cc.teambee.iot.http.IoTClientImpl;
import cc.teambee.iot.entity.GeneralResponse;
import cc.teambee.iot.entity.v2025.CreateDeviceRequest;
import cc.teambee.iot.entity.v2025.UpdateDeviceRequest;
import cc.teambee.iot.common.exception.ClientException;
import java.util.HashMap;
import java.util.Map;

public class IoTDeviceLifecycleExample {

    private static final String PRODUCT_KEY = "your-product-key";
    private static final String DEVICE_ID = "test-device-001";

    public static void main(String[] args) {
        try {
            // 1. åˆ›å»ºIoTå®¢æˆ·ç«¯
            IoTClient iotClient = new IoTClientImpl();

            // 2. æ³¨å†Œè®¾å¤‡
            registerDevice(iotClient);

            // 3. è®¾å¤‡ä¸Šçº¿
            onlineDevice(iotClient);

            // 4. ä¸ŠæŠ¥å±æ€§
            reportProperties(iotClient);

            // 5. ä¸ŠæŠ¥äº‹ä»¶
            reportEvent(iotClient);

            // 6. æŸ¥è¯¢è®¾å¤‡ä¿¡æ¯
            queryDevice(iotClient);

            // 7. æ›´æ–°è®¾å¤‡ä¿¡æ¯
            updateDevice(iotClient);

            // 8. åˆ é™¤è®¾å¤‡
            deleteDevice(iotClient);

        } catch (ClientException e) {
            System.err.println("IoTæ“ä½œå¤±è´¥: " + e.getMessage());
            e.printStackTrace();
        }
    }

    private static void registerDevice(IoTClient iotClient) throws ClientException {
        CreateDeviceRequest request = new CreateDeviceRequest(PRODUCT_KEY);
        request.setDeviceId(DEVICE_ID);
        request.setDeviceName("æµ‹è¯•è®¾å¤‡");
        request.setLatitude("31.207561");
        request.setLongitude("120.23475");
        request.setIgnoreRepeat(true);

        String result = iotClient.register(request);
        System.out.println("è®¾å¤‡æ³¨å†ŒæˆåŠŸ: " + result);
    }

    private static void onlineDevice(IoTClient iotClient) throws ClientException {
        GeneralResponse response = iotClient.online(PRODUCT_KEY, DEVICE_ID);
        if (response.getCode() == 0) {
            System.out.println("è®¾å¤‡ä¸Šçº¿æˆåŠŸ");
        }
    }

    private static void reportProperties(IoTClient iotClient) throws ClientException {
        Map<String, Object> properties = new HashMap<>();
        properties.put("temperature", 25.5);
        properties.put("humidity", 60.0);

        GeneralResponse response = iotClient.reportProperties(PRODUCT_KEY, DEVICE_ID, properties);
        if (response.getCode() == 0) {
            System.out.println("å±æ€§ä¸ŠæŠ¥æˆåŠŸ");
        }
    }

    private static void reportEvent(IoTClient iotClient) throws ClientException {
        Map<String, Object> eventData = new HashMap<>();
        eventData.put("alarmLevel", "medium");
        eventData.put("alarmMessage", "æ¸©åº¦å¼‚å¸¸");

        GeneralResponse response = iotClient.reportEvent(PRODUCT_KEY, DEVICE_ID, "temperatureAlarm", eventData);
        if (response.getCode() == 0) {
            System.out.println("äº‹ä»¶ä¸ŠæŠ¥æˆåŠŸ");
        }
    }

    private static void queryDevice(IoTClient iotClient) throws ClientException {
        GeneralResponse response = iotClient.query(PRODUCT_KEY, DEVICE_ID);
        if (response.getCode() == 0) {
            System.out.println("è®¾å¤‡ä¿¡æ¯: " + response.getResult());
        }
    }

    private static void updateDevice(IoTClient iotClient) throws ClientException {
        UpdateDeviceRequest updateRequest = new UpdateDeviceRequest(PRODUCT_KEY, DEVICE_ID);
        updateRequest.setDeviceName("æ›´æ–°åçš„æµ‹è¯•è®¾å¤‡");
        updateRequest.setDetail("è®¾å¤‡å·²æ›´æ–°");

        GeneralResponse response = iotClient.update(updateRequest);
        if (response.getCode() == 0) {
            System.out.println("è®¾å¤‡æ›´æ–°æˆåŠŸ");
        }
    }

    private static void deleteDevice(IoTClient iotClient) throws ClientException {
        GeneralResponse response = iotClient.delete(PRODUCT_KEY, DEVICE_ID);
        if (response.getCode() == 0) {
            System.out.println("è®¾å¤‡åˆ é™¤æˆåŠŸ");
        }
    }
}
```

## è®¤è¯æ–¹å¼

SDKæ”¯æŒä¸¤ç§è®¤è¯æ–¹å¼ï¼š

### 1. å®¢æˆ·ç«¯è®¤è¯ (Client Credentials)

é€‚ç”¨äºæœåŠ¡é—´è°ƒç”¨ï¼Œä½¿ç”¨å®¢æˆ·ç«¯IDå’Œå¯†é’¥è¿›è¡Œè®¤è¯ã€‚

```properties
universal.iot.grantType=client_credentials
universal.iot.clientId=your-client-id
universal.iot.clientSecret=your-client-secret
```

### 2. å¯†ç è®¤è¯ (Password)

é€‚ç”¨äºç”¨æˆ·ç™»å½•åœºæ™¯ï¼Œä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œè®¤è¯ã€‚

```properties
universal.iot.grantType=password
universal.iot.username=your-username
universal.iot.password=your-password
universal.iot.pwdClientId=your-pwd-client-id
universal.iot.pwdClientSecret=your-pwd-client-secret
```

## é”™è¯¯å¤„ç†

SDKå¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ï¼š

### ClientException

å®¢æˆ·ç«¯å¼‚å¸¸ï¼Œé€šå¸¸ç”±ä»¥ä¸‹åŸå› å¼•èµ·ï¼š

- ç½‘ç»œè¿æ¥å¤±è´¥
- è®¤è¯ä¿¡æ¯é”™è¯¯
- è¯·æ±‚å‚æ•°æ— æ•ˆ

```java
try {
    IoTClient iotClient = new IoTClientImpl();
    // æ‰§è¡Œæ“ä½œ...
} catch (ClientException e) {
    System.err.println("å®¢æˆ·ç«¯å¼‚å¸¸: " + e.getMessage());
    // å¤„ç†å¼‚å¸¸...
}
```

### ServerException

æœåŠ¡å™¨å¼‚å¸¸ï¼Œé€šå¸¸ç”±ä»¥ä¸‹åŸå› å¼•èµ·ï¼š

- æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- APIè°ƒç”¨é¢‘ç‡è¶…é™
- æœåŠ¡å™¨ç»´æŠ¤

```java
try {
    // æ‰§è¡Œæ“ä½œ...
} catch (ServerException e) {
    System.err.println("æœåŠ¡å™¨å¼‚å¸¸: " + e.getMessage());
    // å¤„ç†å¼‚å¸¸...
}
```

## æœ€ä½³å®è·µ

### 1. å¼‚å¸¸å¤„ç†

å§‹ç»ˆä½¿ç”¨try-catchå—åŒ…è£…SDKè°ƒç”¨ï¼Œå¹¶é€‚å½“å¤„ç†å¼‚å¸¸ã€‚

### 2. èµ„æºç®¡ç†

ç¡®ä¿åœ¨åº”ç”¨å…³é—­æ—¶æ­£ç¡®é‡Šæ”¾èµ„æºã€‚

### 3. é‡è¯•æœºåˆ¶

å¯¹äºç½‘ç»œç›¸å…³çš„æ“ä½œï¼Œå»ºè®®å®ç°é‡è¯•æœºåˆ¶ã€‚

```java
public class IoTClientWithRetry {
    private static final int MAX_RETRIES = 3;
    private static final long RETRY_DELAY = 1000; // 1ç§’

    public static GeneralResponse onlineWithRetry(IoTClient client, String productKey, String deviceId) {
        for (int i = 0; i < MAX_RETRIES; i++) {
            try {
                return client.online(productKey, deviceId);
            } catch (ClientException e) {
                if (i == MAX_RETRIES - 1) {
                    throw e;
                }
                try {
                    Thread.sleep(RETRY_DELAY);
                } catch (InterruptedException ie) {
                    Thread.currentThread().interrupt();
                    throw new ClientException("é‡è¯•è¢«ä¸­æ–­", e);
                }
            }
        }
        throw new ClientException("é‡è¯•æ¬¡æ•°å·²ç”¨å®Œ");
    }
}
```

### 4. æ—¥å¿—è®°å½•

å»ºè®®ä½¿ç”¨æ—¥å¿—æ¡†æ¶è®°å½•SDKæ“ä½œï¼Œä¾¿äºé—®é¢˜æ’æŸ¥ã€‚

```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class IoTService {
    private static final Logger logger = LoggerFactory.getLogger(IoTService.class);

    public void registerDevice(String deviceId, String deviceName) {
        try {
            logger.info("å¼€å§‹æ³¨å†Œè®¾å¤‡: {}", deviceId);
            // æ‰§è¡Œæ³¨å†Œæ“ä½œ...
            logger.info("è®¾å¤‡æ³¨å†ŒæˆåŠŸ: {}", deviceId);
        } catch (Exception e) {
            logger.error("è®¾å¤‡æ³¨å†Œå¤±è´¥: {}", deviceId, e);
            throw e;
        }
    }
}
```

### 5. é…ç½®ç®¡ç†

å°†é…ç½®ä¿¡æ¯å¤–éƒ¨åŒ–ï¼Œä¾¿äºä¸åŒç¯å¢ƒçš„éƒ¨ç½²ã€‚

```java
public class IoTConfig {
    private String host;
    private String clientId;
    private String clientSecret;
    private String grantType;

    // ä»é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡åŠ è½½é…ç½®
    public static IoTConfig load() {
        // å®ç°é…ç½®åŠ è½½é€»è¾‘
        return new IoTConfig();
    }
}
```

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•è·å–äº§å“å¯†é’¥ (productKey)ï¼Ÿ

A: äº§å“å¯†é’¥éœ€è¦åœ¨IoTå¹³å°çš„ `åŒ—å‘åº”ç”¨` åˆ›å»ºäº§å“åè·å¾—ï¼Œè¯·è”ç³»å¹³å°ç®¡ç†å‘˜è·å–ã€‚

### Q2: è®¾å¤‡IDå¯ä»¥é‡å¤å—ï¼Ÿ

A: è®¾å¤‡IDåœ¨åŒä¸€äº§å“ä¸‹å¿…é¡»å”¯ä¸€ï¼Œå»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‡è¯†ç¬¦ã€‚

### Q3: å¦‚ä½•å¤„ç†ç½‘ç»œè¶…æ—¶ï¼Ÿ

A: å»ºè®®å®ç°é‡è¯•æœºåˆ¶ï¼Œå¹¶è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ã€‚

### Q4: æ”¯æŒå“ªäº›æ•°æ®ç±»å‹çš„å±æ€§ä¸ŠæŠ¥ï¼Ÿ

A: æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆStringã€Integerã€Doubleã€Booleanç­‰ï¼‰å’Œå¤æ‚å¯¹è±¡ã€‚

### Q5: å¦‚ä½•æ‰¹é‡æ“ä½œè®¾å¤‡ï¼Ÿ

A: ç›®å‰SDKæ”¯æŒå•ä¸ªè®¾å¤‡æ“ä½œï¼Œæ‰¹é‡æ“ä½œéœ€è¦å¾ªç¯è°ƒç”¨APIã€‚

## æŠ€æœ¯æ”¯æŒ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¸®åŠ©ï¼š


- ğŸ’¬ **ç¤¾åŒº**: åŠ å…¥å¼€å‘è€…ç¤¾åŒºè®¨è®º
- ğŸ› **é—®é¢˜åé¦ˆ**: åœ¨GitHubä¸Šæäº¤Issue

## æ›´æ–°æ—¥å¿—

### v1.0.0

- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒè®¾å¤‡ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ”¯æŒå±æ€§ä¸ŠæŠ¥å’Œäº‹ä»¶ä¸ŠæŠ¥
- æ”¯æŒOAuth2è®¤è¯

---

_æœ¬æ–‡æ¡£åŸºäº Universal IoT SDK v1.0.0 ç¼–å†™ï¼Œå¦‚æœ‰æ›´æ–°è¯·å‚è€ƒæœ€æ–°ç‰ˆæœ¬æ–‡æ¡£ã€‚_
