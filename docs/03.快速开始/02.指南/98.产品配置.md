---
title: 产品配置
date: 2025-11-29 18:00:00
permalink: /product/config
categories:
  - 快速开始
tags:
  - 快速开始
  - 指南
---

### 设备在线的规则

默认24小时没有收到消息，会`自动下线`。

::: info 
**操作步骤：**

1. 进入 `所有产品` → 选择对应的产品 → `产品详情`
2. 点击 `公共配置` 标签页
3. 点击 `编辑` 按钮
4. 找到 `离线判定时间​(分)` 选项
5. 填入 **你想要的任意**，保存配置
::::

## 设备历史数据存储与查看

**什么是数据留存？**

平台会自动保存设备上报的所有属性数据和事件数据，方便您随时查看历史记录和进行数据分析。

**功能说明**

- **设置策略**：存储策略设置，每个产品的属性和事件数据都会单独存储，互不干扰
- **便于分析**：可以查看每个属性的历史趋势图，进行数据统计和分析
- **查看方式**：在 `设备详情` → `实时状态` 页面，每个属性旁边会显示 `历史` 按钮

![接入](/03/cccl.png "存储策略")

点击 `历史` 按钮后，您可以：

- 查看该属性的所有历史数据记录
- 查看数据趋势图表
- 进行时间范围筛选和数据分析

---

## 新设备自动注册功能

**什么是主动注册？**

**主动注册**是指设备首次连接平台时，平台自动创建设备信息，无需您手动添加设备信息，方便调试。

**如何开启？**

**操作步骤：**

1. 进入 `所有产品` → 选择对应的产品 → `产品详情`
2. 点击 `公共配置` 标签页
3. 点击 `编辑` 按钮
4. 找到 `自动注册新设备` 选项
5. 选择 **是**，保存配置

**⚠️ 重要注意事项**

::: warning 权限说明
**1. 设备权限归属**

- 自动注册的设备，`create_id` 会被设置为 `auto_register`
- **只有超级管理员**才能查看到这些自动注册的设备
- 普通用户无法看到自动注册的设备，除非手动添加后设备会划转给您
:::

::: tip 开发调试
**2. 调试模式下的特殊设备**

当使用 `TCP` 或 `MQTT组件（非内置MQTT）` 方式接入时：

**工作原理：**

1. **设备识别的重要性**
   - 任意协议和任意报文，平台首先需要确认"这条消息来自哪个设备"
   - 因此需要在 `preDecode` 中编写规则来确定设备的 `deviceId`

2. **默认调试设备**
   - 如果您还没有编写 `preDecode` 规则来确定 `deviceId`
   - 平台会**自动创建一个名为 `nexiotDebugDeviceId` 的调试设备**
   - 所有无法识别设备的消息都会发送到这个调试设备

3. **编写识别规则**
   - 在 IDE 调试器的 `preDecode` 中编写设备 `deviceId` 的确定逻辑
   - 编写完成后，设备就能被正确识别，不再使用调试设备

4. **查看调试信息**
   - 您可以在 `日志管理` 中查看 `nexiotDebugDeviceId` 设备的所有消息
   - 方便您分析报文格式，编写正确的协议解析规则

**相关视频教程：**

[【NexIoT】TCP 全流程｜调试神技巧：默认设备兜底，先显消息再搞解析](https://www.bilibili.com/video/BV1gr2WBiEmD/?share_source=copy_web&vd_source=c9e1500efcc8aa0763f711fadaa68dff)
:::

![接入](/03/noCodec.png "主动注册")

**如果您选择手动添加设备**

- 设备会**划转给您**，您拥有该设备的完整权限
- 可以正常查看和管理该设备
- 适合需要提前配置设备信息的场景

---

## 设备实时定位与位置追踪

**什么是定位功能？**

开启此功能后，平台会根据设备上报的位置信息，在地图上实时显示设备的位置

**如何开启定位功能？**

**操作步骤：**

1. 进入 `所有产品` → 选择对应的产品 → `产品详情`
2. 点击 `公共配置` 标签页
3. 点击 `编辑` 按钮
4. 找到 `定位设备` 选项
5. 选择 **是**，保存配置

**📋 配置要求**

::: warning 物模型配置要求
**必须满足以下条件：**

1. **字段名称**：物模型中必须包含名为 `coordinates` 的字段
2. **数据格式**：字段值必须是 `经度,纬度` 的格式
3. **示例**：`110.395041,22.062448`（经度在前，纬度在后，用英文逗号分隔）

**正确示例：**

```text
coordinates: "110.395041,22.062448"  ✅
coordinates: "22.062448,110.395041"  ❌ 错误（纬度在前）
coordinates: "110.395041 22.062448"  ❌ 错误（缺少逗号）
```

:::

**定位功能说明**

开启定位功能后：

- 设备上报位置数据时，平台会自动更新设备在地图上的位置
- 可以在设备详情页面查看设备的实时位置
- 支持查看设备的历史位置轨迹
- 适用于车辆、人员、资产等需要位置追踪的场景

## 设备数据格式配置（16进制/字符串）

**什么是数据交换类型？**

数据交换类型用于配置平台与设备之间的数据传输格式。主要面向 MQTT 和 TCP 设备，当设备端严格按照 16 进制发送和接收数据时，需要正确配置此选项。

**支持的数据类型**

平台支持两种数据交换类型：

- **二进制转字符串（String）**：将二进制数据转换为 UTF-8 字符串，默认使用 `StrUtil.str(bytes, CharsetUtil.UTF_8)`
- **HEX（16进制）**：直接使用 16 进制格式传输数据，使用`HexUtil.encodeHexStr(bytes)`

**配置说明**

- **发送数据类型**：平台发送给设备的数据格式
- **接收数据类型**：平台接收设备数据的数据格式

**配置建议**

::: warning 注意事项
1. **仔细核对设备要求**：有些设备可能只对一端（发送或接收）做了特殊处理，请根据实际情况按需配置
2. **不必全部修改**：如果设备两端都使用相同格式，可以只配置一端，不必同时修改两个选项
3. **测试验证**：配置后建议先进行测试，确保设备能正常收发数据
:::

![接入](/03/hexstr.png "数据交换类型配置")
